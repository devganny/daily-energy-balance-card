<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Energy Balance Card Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: var(--background-color, #111);
            color: var(--text-color, white);
            margin: 0;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        body.light-theme {
            --background-color: #f5f5f5;
            --text-color: #333;
            --card-background: #ffffff;
            --card-shadow: 0 2px 8px rgba(0,0,0,0.1);
            --primary-text-color: #333;
            --secondary-text-color: #666;
            --input-background: #f0f0f0;
        }
        
        body.dark-theme {
            --background-color: #111;
            --text-color: white;
            --card-background: linear-gradient(135deg, #2c3e50, #34495e);
            --card-shadow: 0 8px 32px rgba(0,0,0,0.3);
            --primary-text-color: white;
            --secondary-text-color: #bdc3c7;
            --input-background: #555;
        }
        .controls {
            background: var(--card-background, #333);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
            box-shadow: var(--card-shadow, 0 2px 8px rgba(0,0,0,0.3));
        }
        .controls input {
            width: 80px;
            padding: 5px;
            border: none;
            border-radius: 4px;
            background: var(--input-background, #555);
            color: var(--text-color, white);
        }
        .card-wrapper {
            background: var(--card-background, #333);
            border-radius: 8px;
            padding: 20px;
            margin: 0;
            transition: all 0.3s ease;
            box-shadow: var(--card-shadow, 0 2px 8px rgba(0,0,0,0.3));
        }
        button {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            background: #007cba;
            color: white;
            cursor: pointer;
        }
        button:hover { background: #005a87; }
    </style>
</head>
<body>
    <h1>üöÄ Daily Energy Balance Card Test</h1>
    
    <div class="controls">
        <label>Breite:</label>
        <input type="number" id="width-input" value="800" min="300" max="2000" step="50">
        <label>H√∂he:</label>
        <input type="number" id="height-input" value="500" min="300" max="1500" step="50">
        <button onclick="resizeCard()">Gr√∂√üe anwenden</button>
        <button onclick="updateData()">Daten aktualisieren</button>
        <button onclick="randomizeData()">Zuf√§llige Daten</button>
        <button onclick="toggleTheme()" id="theme-toggle">üåô Dark Mode</button>
    </div>
    
    <div class="card-wrapper" id="card-wrapper">
        <div style="text-align: center; padding: 50px; color: #666;">
            Card wird geladen...
        </div>
    </div>

    <script src="daily-energy-balance-card.js"></script>

    <script>
        // Mock Home Assistant object
        const mockHass = {
            states: {
                'sensor.energy_solar': { state: '25.9' },
                'sensor.energy_grid_in': { state: '0.2' },
                'sensor.energy_battery_out': { state: '5.9' },
                'sensor.energy_consumption_daily': { state: '18.3' },
                'sensor.car_consumption': { state: '0.0' },
                'sensor.energy_grid_out': { state: '4.2' },
                'sensor.energy_battery_in': { state: '9.3' }
            }
        };

        // Card configuration
        const cardConfig = {
            title: 'Daily Energy Balance',
            entities: {
                pv: 'sensor.energy_solar',
                purchase: 'sensor.energy_grid_in',
                discharge: 'sensor.energy_battery_out',
                house: 'sensor.energy_consumption_daily',
                car: 'sensor.car_consumption',
                sale: 'sensor.energy_grid_out',
                charge: 'sensor.energy_battery_in'
            },
            labels: {
                pv: 'PV',
                purchase: 'Purchase',
                discharge: 'Battery',
                house: 'House',
                car: 'Car',
                sale: 'Sale',
                charge: 'Battery'
            },
            colors: {
                pv: '#f39c12',        // Orange for PV
                purchase: '#e74c3c',   // Red for grid purchase
                discharge: '#27ae60',  // Green for battery discharge
                house: '#3498db',      // Blue for house consumption
                car: '#9b59b6',        // Purple for car
                sale: '#e67e22',       // Orange-red for grid sale
                charge: '#2ecc71'      // Light green for battery charge
            }
        };

        // Initialize card
        function initCard() {
            const wrapper = document.getElementById('card-wrapper');
            
            // Set initial size
            const width = document.getElementById('width-input').value;
            const height = document.getElementById('height-input').value;
            wrapper.style.width = width + 'px';
            wrapper.style.height = height + 'px';
            
            // Use renderEnergyCard function directly
            wrapper.innerHTML = renderEnergyCard(cardConfig, mockHass, height);
            
            console.log('Card successfully initialized!');
        }

        // Update data
        function updateData() {
            const wrapper = document.getElementById('card-wrapper');
            const height = document.getElementById('height-input').value;
            wrapper.innerHTML = renderEnergyCard(cardConfig, mockHass, height);
            console.log('Data updated');
        }

        // Generate random data
        function randomizeData() {
            Object.keys(mockHass.states).forEach(key => {
                mockHass.states[key].state = (Math.random() * 50).toFixed(1);
            });
            updateData();
        }

        // Resize card
        function resizeCard() {
            const width = document.getElementById('width-input').value;
            const height = document.getElementById('height-input').value;
            const wrapper = document.getElementById('card-wrapper');
            
            wrapper.style.width = width + 'px';
            wrapper.style.height = height + 'px';
            
            // Re-render card with new container height
            wrapper.innerHTML = renderEnergyCard(cardConfig, mockHass, height);
            
            console.log('Card size changed to:', width + 'x' + height);
        }

        // Theme switcher
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('theme-toggle');
            
            if (body.classList.contains('dark-theme')) {
                body.classList.remove('dark-theme');
                body.classList.add('light-theme');
                themeToggle.textContent = '‚òÄÔ∏è Light Mode';
            } else {
                body.classList.remove('light-theme');
                body.classList.add('dark-theme');
                themeToggle.textContent = 'üåô Dark Mode';
            }
            
            // Re-render card to apply theme changes
            updateData();
        }

        // Initialize when page loads
        window.addEventListener('load', function() {
            console.log('Page loaded');
            // Default to dark theme
            document.body.classList.add('dark-theme');
            initCard();
        });
    </script>
</body>
</html> 